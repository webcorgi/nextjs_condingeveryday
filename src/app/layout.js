import "./globals.css";
import Link from 'next/link'
import { Control } from "./Control";
import connection from "@/lib/mysql";

export const metadata = {
  title: 'WEB tutorial',
  description: 'Generated by egoing',
}
export default async function RootLayout({ children, topics }) {
  // nextjsëŠ” fetchì‹œ ëª¨ë‘ ìºì‹œë˜ë¯€ë¡œ, ê¸€ ìƒì„±í›„ ìƒˆë¡œìš´ ëª©ë¡ì„ ê°€ì ¸ì˜¤ë ¤ë©´ ìºì‹œí•˜ì§€ ì•Šì•„ì•¼í•œë‹¤. ê·¸ë˜ì„œ 'no-cache'ë¥¼ ë„£ì–´ì¤Œ.
  /* const resp = await fetch(`${process.env.NEXT_PUBLIC_API_URL}topics/`, {cache:'no-cache'})
  const topics = await resp.json(); */

  /* mysql */
  const [rows, fields] = await connection.query(
    'SELECT * FROM topics'
  );
  // const topics = await rows.json()
  console.log("ğŸš€ ~ TopicsPage ~ rows:", rows)

  return (
    <html>
      <body>
        <h1><Link href="/">WEB</Link></h1>
        {/* <ol>
          {
            topics.map(topic=> {
              return <li key={topic.id}>
                <Link href={`/read/${topic.id}`}>{topic.title}</Link>
              </li>
            })
          }
        </ol> */}
        <ol>
          {
            rows.map(topic=> {
              return <li key={topic.id}>
                <Link href={`/read/${topic.id}`}>{topic.title}</Link>
              </li>
            })
          }
        </ol>
        {children}
        <Control />
      </body>
    </html>
  )
}